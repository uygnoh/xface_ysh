/*******************************************************************************
        => 定时器__TMR0__
*******************************************************************************/
//_____________________________________________________________
// TMR0（定时器/计数器）
//_____________________________________________________________

//_____________________________________________________________
// OPTION_REG（选项寄存器）
//_____________________________________________________________
PS2, PS1, PS0           //设置预分频值
PSA                     //选择预分频值分配给（定时器， 看门狗）
T0SE                    //外部计数器模式使用（上升沿或下降沿触发）
T0CS                    //设置为外部触发（计数器），或内部触发（定时器）

//_____________________________________________________________
// INTCON（中断控制寄存器）
//_____________________________________________________________
GIE                     //总中断控制位
T0IE                    //定时器（0）中断控制位
T0IF                    //定时器（0）中断标志位

//_____________________________________________________________
// TRISA（端口RA方向寄存器）
//_____________________________________________________________
如果（作为外部计数模式），相应的引脚必需设置为（输入模式）



/*******************************************************************************
        => pic16f877a
        1. 外部晶振为（4MHz）
        2. 定时器0的时钟频率为（1MHz）
        3. 定时器0上电自动运行
        4. 使用查询法（定时1秒钟）
*******************************************************************************/
#include <pic.h>
#define uint8_t         unsigned char
#define uint16_t        unsigned int
__CONFIG(0x3B31);

uint16_t t0_cnt;
void main(void)
{
        timer0_init();
        while (1) {
                if (T0IF == 1) {
                        T0IF = 0;
                        t0_cnt++;
                        if (t0 == 3906) {
                                t0_cnt = 0;
                                RD0 = !RD0;
                        }
                }
        }
}

void timer0_init(void)
{
        TRISD  = 0x00;
        PORTD  = 0x00;
        OPTION = 0x08;          //PSA=1（不使用预分频器）
}




/*******************************************************************************
        => pic16f877a
*******************************************************************************/
#include <pic.h>
#define uint8_t         unsigned char
#define uint16_t        unsigned int
__CONFIG(0x3B31);

uint16_t t0_cnt;
void main(void)
{
        timer0_init();
        while (1) {
                if (t0_cnt == 10) {
                        t0_cnt = 0;
                        RD0 = !RD0;
                }
        }
}

void timer0_init(void)
{
        TRISD  = 0x00;
        PORTD  = 0x00;
        OPTION = 0x07;          //PSA=0（预分频器值为256）
        INTCON = 0xA0;          //GIE=1; T0IE=1;
        TMR0   = 61;            //定时器0初值设置为（61）
}

void interrupt time0(void)
{
        T0IF = 0;
        TMR0 = 61;
        t0_cnt++;
}

